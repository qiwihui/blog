---
title: "SVG NFT å…¨é¢å®è·µ â”€â”€ scaffold-eth loogies-svg-nft é¡¹ç›®å®Œæ•´æŒ‡å—"
description: "SVG NFT å…¨é¢å®è·µ â”€â”€ scaffold-eth loogies-svg-nft é¡¹ç›®å®Œæ•´æŒ‡å—"
tags: 
- åŒºå—é“¾
top: 153
date: 14/02/2022, 15:55:49
author: qiwihui
update: 15/02/2022, 11:38:41
categories: æŠ€æœ¯
---

æ³¨ï¼šè¿™ç¯‡æ–‡ç« æ˜¯æˆ‘æŠ•ç¨¿äºâ€œæå¤§ç‹—Leeduckgoâ€å…¬ä¼—å·çš„æ–‡ç« ï¼ŒåŸæ–‡åœ°å€ï¼š[SVG NFT å…¨é¢å®è·µ | Web3.0 dApp å¼€å‘ï¼ˆå…­ï¼‰](https://mp.weixin.qq.com/s/WvTFk3E6FjfHtXfp2uHkrw)ã€‚

---

loogies-svg-nft æ˜¯ scaffold-eth æä¾›çš„ä¸€ä¸ªç®€å•çš„ NFT é“¸é€ å’Œå±•ç¤ºçš„é¡¹ç›®ï¼Œåœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†å¸¦é¢†å¤§å®¶ä¸€æ­¥æ­¥åˆ†æå’Œå®ç°è¿™ä¸ªé¡¹ç›®ã€‚

ç”±äºé¡¹ç›®çš„ `loogies-svg-nft` åˆ†æ”¯ä¸ `master` åˆ†æ”¯åœ¨ç»„ä»¶åº“å’Œä¸»é¡µä¸Šæœ‰ä¸€äº›å˜åŒ–ï¼Œæ•…å…ˆå°† `master` åˆ†æ”¯ä»£ç ä¸ `loogies-svg-nft` åˆ†æ”¯è¿›è¡Œäº†åˆå¹¶ï¼Œè§£å†³å†²çªï¼Œå¾—åˆ°ä¸€ä»½åŸºæ–°ç»„ä»¶åº“çš„å…¨æ–°çš„ä»£ç ã€‚å¯ä»¥å‚è€ƒé¡¹ç›®åœ°å€ï¼š [https://github.com/qiwihui/scaffold-eth.git](https://github.com/qiwihui/scaffold-eth.git) çš„ `loogies-svg-nft` åˆ†æ”¯ã€‚æœ¬æ–‡ä»¥ä¸‹å†…å®¹å°†åŸºäºè¿™äº›ä»£ç è¿›è¡Œéƒ¨ç½²å’Œåˆ†æã€‚

<!--more-->

## æœ¬åœ°è¿è¡Œå’Œæµ‹è¯•

é¦–å…ˆæˆ‘ä»¬å…ˆè¿è¡Œé¡¹ç›®æŸ¥çœ‹æˆ‘ä»¬å°†è¦åˆ†æå®ç°çš„åŠŸèƒ½ã€‚

### æœ¬åœ°è¿è¡Œ

é¦–å…ˆæˆ‘ä»¬åœ¨æœ¬åœ°è¿è¡Œé¡¹ç›®ï¼š

clone é¡¹ç›®å¹¶åˆ‡æ¢åˆ° `loogies-svg-nft` åˆ†æ”¯ï¼š

```bash
git clone https://github.com/qiwihui/scaffold-eth.git loogies-svg-nft
cd loogies-svg-nft
git checkout loogies-svg-nft
```

å®‰è£…ä¾èµ–åŒ…

```bash
yarn install
```
    
è¿è¡Œå‰ç«¯
    
```bash
yarn start
```
    
åœ¨ç¬¬äºŒä¸ªç»ˆç«¯çª—å£ä¸­ï¼Œè¿è¡Œæœ¬åœ°æµ‹è¯•é“¾
    
```bash
yarn chain
```
    
![yarn-chain](https://user-images.githubusercontent.com/3297411/153822009-3154003e-6433-4a29-a511-b33b5f37a99a.png)
    
åœ¨ç¬¬ä¸‰ä¸ªç»ˆç«¯çª—å£ä¸­ï¼Œè¿è¡Œéƒ¨ç½²åˆçº¦
    
```bash
yarn deploy
```
    
![yarn-deploy](https://user-images.githubusercontent.com/3297411/153822065-4c4a0ffa-95e3-4e16-8272-ace2f102625b.png)
    
æ­¤æ—¶åœ¨æµè§ˆå™¨ä¸­è®¿é—® [`http://localhost:3000`](http://localhost:3000/) ï¼Œå°±å¯ä»¥çœ‹åˆ°ç¨‹åºäº†ã€‚

![yarn-start](https://user-images.githubusercontent.com/3297411/153822123-f6f7e3b0-ac6e-4625-a0bd-9bc4170d6aeb.png)

### æœ¬åœ°æµ‹è¯•

1. é¦–å…ˆåœ¨ MetaMask é’±åŒ…ä¸­æ·»åŠ æœ¬åœ°ç½‘ç»œï¼Œå¹¶åˆ‡æ¢åˆ°æœ¬åœ°ç½‘ç»œï¼›
    - ç½‘ç»œåç§°ï¼š `Localhost 8545`
    - æ–°å¢ RPC URLï¼š `http://localhost:8545`
    - é“¾ IDï¼š `31337`
    - Currency Symbolï¼š `ETH`
2. åˆ›å»ºä¸€ä¸ªæ–°çš„æœ¬åœ°é’±åŒ…è´¦å·ï¼›
3. å¤åˆ¶é’±åŒ…åœ°å€ï¼Œåœ¨é¡µé¢å·¦ä¸‹è§’ç»™è¿™ä¸ªåœ°å€å‘é€ä¸€äº›æµ‹è¯• ETHï¼›
4. ç‚¹å‡»åœ¨é¡µé¢å³ä¸Šè§’ `connect` è¿æ¥é’±åŒ…ï¼›
5. ç‚¹å‡» Mint é“¸é€ ï¼›
6. å½“äº¤æ˜“æˆåŠŸåï¼Œå¯ä»¥çœ‹åˆ°æ–°é“¸é€ çš„ NFTï¼›

	![nft-display](https://user-images.githubusercontent.com/3297411/153822198-6442f4d1-fa49-43e1-bb7c-eacc1b1d082d.png)

ä¸‹é¢ï¼Œæˆ‘ä»¬å¼€å§‹å¯¹é¡¹ç›®åˆçº¦è¿›è¡Œåˆ†æã€‚

## Loogies åˆçº¦åˆ†æ

### NFT ä¸ ERC721

**NFT**ï¼Œå…¨ç§°ä¸ºNon-Fungible Tokenï¼ŒæŒ‡éåŒè´¨åŒ–ä»£å¸ï¼Œå¯¹åº”äºä»¥å¤ªåŠä¸Š ERC-721 æ ‡å‡†ã€‚ ä¸€èˆ¬åœ¨æ™ºèƒ½åˆçº¦ä¸­ï¼ŒNFT çš„å®šä¹‰åŒ…å« `tokenId` å’Œ `tokenURI` ï¼Œæ¯ä¸€ä¸ª NFT çš„ `tokenId` æ˜¯å”¯ä¸€çš„ï¼Œ `tokenURI` å¯¹äºä¿å­˜äº†NFTçš„å…ƒæ•°æ®ï¼Œå¯ä»¥æ˜¯å›¾åƒURLã€æè¿°ã€å±æ€§ç­‰ã€‚å¦‚æœä¸€ä¸ª NFT æƒ³åœ¨ NFT å¸‚åœºä¸Šè¿›è¡Œå±•ç¤ºå’Œé”€å”®ï¼Œåˆ™ `tokenURI` å†…å®¹éœ€è¦å¯¹åº”ç¬¦åˆ NFT å¸‚åœºçš„æ ‡å‡†ï¼Œæ¯”å¦‚ï¼Œåœ¨ NFT å¸‚åœº OpenSea [å…ƒæ•°æ®æ ‡å‡†](https://docs.opensea.io/docs/metadata-standards)ä¸­ï¼Œå°±æŒ‡å‡ºäº† NFT å±•ç¤ºéœ€è¦è®¾ç½®çš„å±æ€§ã€‚

![OpenSea ä¸­ NFT å…ƒæ•°æ®ä¸å±•ç¤ºå¯¹åº”å…³ç³»](https://user-images.githubusercontent.com/3297411/153822292-ac9fa169-199b-49cb-b8bd-4ec3e680842c.png)

OpenSea ä¸­ NFT å…ƒæ•°æ®ä¸å±•ç¤ºå¯¹åº”å…³ç³»

### åˆçº¦æ¦‚è§ˆ

[loogies-svg-nft é¡¹ç›®](https://github.com/scaffold-eth/scaffold-eth/tree/loogies-svg-nft)çš„åˆçº¦æ–‡ä»¶åœ¨ `packages/hardhat/contracts/` è·¯å¾„ä¸‹ï¼ŒåŒ…å«ä»¥ä¸‹ä¸‰ä¸ªæ–‡ä»¶ï¼š

```bash
packages/hardhat/contracts/
â”œâ”€â”€ HexStrings.sol
â”œâ”€â”€ ToColor.sol
â””â”€â”€ YourCollectible.sol
```

- `HexString.sol` ï¼šç”Ÿæˆåœ°å€å­—ç¬¦ä¸²ï¼›
- `ToColor.sol`ï¼šç”Ÿæˆé¢œè‰²ç¼–ç å­—ç¬¦ä¸²ï¼›
- `YourCollectible.sol`ï¼š `Loogies` NFTçš„åˆçº¦æ–‡ä»¶ï¼Œä¸»è¦åŠŸèƒ½æ¶‰åŠåˆçº¦é“¸é€ å’Œå…ƒæ•°æ®ç”Ÿæˆã€‚

åˆçº¦çš„ä¸»è¦ç»“æ„å’Œæ–¹æ³•ä¸ºï¼š

```solidity
contract YourCollectible is ERC721, Ownable {

	// æ„é€ å‡½æ•°
  constructor() public ERC721("Loogies", "LOOG") {
  }
  // é“¸é€  NFT
  function mintItem()
      public
      returns (uint256)
  {
    ...
  }
	// è·å– tokenId å¯¹åº” tokeURI
  function tokenURI(uint256 id) public view override returns (string memory) {
    ...
  }
	// ç”Ÿæˆ tokenId å¯¹åº” svg ä»£ç 
  function generateSVGofTokenById(uint256 id) internal view returns (string memory) {
    ...
  }

	// ç”Ÿæˆ tokenId å¯¹åº” svg ä»£ç ï¼Œä¸»è¦ç”¨äºç»˜åˆ¶å›¾åƒ
  function renderTokenById(uint256 id) public view returns (string memory) {
    ...
  }

}
```

### æ„é€ å‡½æ•°

```solidity
constructor() public ERC721("Loogies", "LOOG") {
    // RELEASE THE LOOGIES!
  }
```

ä»£å¸ç¬¦å·ï¼š `Loogies`

ä»£å¸åç§°ï¼š `LOOG`

åˆçº¦ç»§æ‰¿è‡ª OpenZeppelin çš„ `ERC721.sol`ï¼Œè¿™æ˜¯ OpenZeppelin æä¾›çš„åŸºæœ¬åˆçº¦ä»£ç ï¼Œå¯ä»¥æ–¹ä¾¿å¼€å‘è€…ä½¿ç”¨ã€‚

### åº”ç”¨åº“å‡½æ•°

åˆçº¦ä¸­åˆ†åˆ«å¯¹ `uint256`ï¼Œ `uint160` å’Œ `bytes3` ç­‰åº”ç”¨äº†ä¸åŒåº“å‡½æ•°ï¼Œæ‰©å±•å¯¹åº”åŠŸèƒ½ï¼š

```solidity
// ä½¿ uint256 å…·æœ‰ toHexString åŠŸèƒ½
using Strings for uint256;
// ä½¿ uint160 å…·æœ‰è‡ªå®šä¹‰ toHexString åŠŸèƒ½
using HexStrings for uint160;
// ä½¿ bytes3 å¯ä»¥æ–¹ä¾¿ç”Ÿæˆå‰ç«¯é¢œè‰²è¡¨ç¤º
using ToColor for bytes3;
// è®¡æ•°åŠŸèƒ½
using Counters for Counters.Counter;
```

### Mint æœŸé™

ä»¥ä¸‹ä»£ç æ˜¯ Mint æ—¶é—´é™åˆ¶ï¼š

```solidity
uint256 mintDeadline = block.timestamp + 24 hours;

function mintItem()
      public
      returns (uint256)
  {
      require( block.timestamp < mintDeadline, "DONE MINTING");
...
```

åˆçº¦åœ¨éƒ¨ç½²ä¹‹åçš„24å°æ—¶å†…å¯ä»¥é“¸é€ ï¼Œè¶…è¿‡24å°æ—¶åˆ™ä¼šå¼•å‘å¼‚å¸¸ã€‚è¿™ä¸ªæœºåˆ¶ç±»ä¼¼äºé¢„å”®ï¼Œç”±äºè¿™ä¸ªåˆçº¦æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥æ²¡æœ‰ä½¿ç”¨ç™½åå•æœºåˆ¶ï¼Œä¸€èˆ¬åœ¨å®é™…æƒ…å†µï¼Œä¼šä½¿ç”¨é¢„å”®å’Œç™½åå•çš„æ–¹å¼æ¥æ§åˆ¶ NFT çš„å‘è¡Œã€‚

### Mint é“¸é€ 

é“¸é€  NFT å…¶å®å°±æ˜¯åœ¨åˆçº¦ä¸­è®¾ç½®ä¸¤ä¸ªä¿¡æ¯ï¼š

- `tokenId` åŠå…¶ `owner`
- `tokenId` åŠå…¶ `tokenURI`

æˆ‘ä»¬é¦–å…ˆçœ‹é“¸é€ å‡½æ•° `mintItem`ï¼š

```solidity
// ç”¨äºä¿å­˜æ¯ä¸€ä¸ªé“¸é€ çš„ Loogies çš„ç‰¹å¾ï¼Œå…¶ä¸­ï¼Œcolor è¡¨ç¤ºé¢œè‰²ï¼Œchubbiness è¡¨ç¤ºèƒ–ç˜¦
mapping (uint256 => bytes3) public color;
mapping (uint256 => uint256) public chubbiness;

...

function mintItem()
      public
      returns (uint256)
  {
      require( block.timestamp < mintDeadline, "DONE MINTING");
			// æ¯æ¬¡é“¸é€ å‰è‡ªå¢ _tokenIdsï¼Œç¡®ä¿ _tokenIds å”¯ä¸€
      _tokenIds.increment();

      uint256 id = _tokenIds.current();
			// é“¸é€ è€…ä¸ tokenId ç»‘å®š
      _mint(msg.sender, id);
			// éšæœºç”Ÿæˆå¯¹åº” tokenId çš„å±æ€§
      bytes32 predictableRandom = keccak256(abi.encodePacked( blockhash(block.number-1), msg.sender, address(this), id ));
      color[id] = bytes2(predictableRandom[0]) | ( bytes2(predictableRandom[1]) >> 8 ) | ( bytes3(predictableRandom[2]) >> 16 );
      chubbiness[id] = 35+((55*uint256(uint8(predictableRandom[3])))/255);

      return id;
  }
```

å…¶ä¸­ï¼š

- `tokenId` åœ¨æ¯æ¬¡é“¸é€ æ—¶ä¼šè‡ªå¢ï¼Œç¡®ä¿ `tokenId` å”¯ä¸€ï¼›
- `_mint` å‡½æ•°ç»‘å®š `tokenId` åŠå…¶ `owner`ï¼›
- æ¯ä¸€ä¸ª `tokenId` å¯¹åº”çš„å±æ€§é€šè¿‡éšæœºæ–¹å¼ç”Ÿæˆï¼Œå…·ä½“ä¸ºï¼š
    - é€šè¿‡å‰ä¸€ä¸ªåŒºå—çš„å“ˆå¸Œï¼ˆ `blockhash(block.number-1)` ï¼‰ï¼Œå½“å‰é“¸é€ è´¦æˆ·ï¼ˆ `msg.sender`ï¼‰ï¼Œåˆçº¦åœ°å€ï¼ˆ `address(this)` ï¼‰å’Œ `tokenId` ç”Ÿæˆå“ˆå¸Œ `predictableRandom`ï¼›
    - è®¡ç®— NFT é¢œè‰²ï¼šæŒ‰ä½æˆ– `predictableRandom` å‰ä¸‰ä½å¾—åˆ°é¢œè‰²ï¼Œé¢œè‰²è¡¨ç¤ºç”¨ bytes3 è¡¨ç¤ºï¼Œå…¶ä¸­ `bytes2(predictableRandom[0])` å¯¹åº”æœ€ä½ä½è“è‰²æ•°å€¼ï¼Œ `( bytes2(predictableRandom[1]) >> 8 )`å¯¹åº”ä¸­é—´ä½ç»¿è‰²æ•°å€¼ï¼Œ `( bytes3(predictableRandom[2]) >> 16 )` å¯¹åº”æœ€é«˜ä½çº¢è‰²æ•°å€¼ï¼›
    - è®¡ç®— NFT èƒ–ç˜¦ï¼š `35+((55*uint256(uint8(predictableRandom[3])))/255);` ï¼Œ`uint8(predictableRandom[3])`ä»‹äº0~255ï¼Œæ•…æœ€å°å€¼ä¸º35ï¼Œæœ€å¤§å€¼ä¸º 35+55 = 90ï¼›

ä¾‹å¦‚ï¼š `color` ä¸º `0x4cc4c1` ï¼Œ `chubbiness` ä¸º 88 æ—¶å¯¹åº”çš„ NFT å›¾ç‰‡ä¸ºï¼š

![loogies-1](https://user-images.githubusercontent.com/3297411/153822433-3a1a41a4-f846-45f9-b74e-f699ccba6a81.png)

### tokenURI å‡½æ•°

å‡½æ•° `tokenURI` æ¥å— `tokenId` å‚æ•°ï¼Œè¿”å›ç¼–ç ä¹‹åçš„å…ƒæ•°æ®å­—ç¬¦ä¸²ï¼š

```solidity
function tokenURI(uint256 id) public view override returns (string memory) {
			// æ£€æŸ¥ id æ˜¯å¦å­˜åœ¨
      require(_exists(id), "not exist");
      string memory name = string(abi.encodePacked('Loogie #',id.toString()));
      string memory description = string(abi.encodePacked('This Loogie is the color #',color[id].toColor(),' with a chubbiness of ',uint2str(chubbiness[id]),'!!!'));
      // ç”Ÿæˆå›¾ç‰‡çš„svg base64 ç¼–ç 
			string memory image = Base64.encode(bytes(generateSVGofTokenById(id)));

      return
          string(
              abi.encodePacked(
                'data:application/json;base64,',
								// é€šè¿‡ base64 ç¼–ç å…ƒæ•°æ®
                Base64.encode(
                    bytes(
                          abi.encodePacked(
                              '{"name":"',
                              name,
                              '", "description":"',
                              description,
                              '", "external_url":"https://burnyboys.com/token/',
                              id.toString(),
                              '", "attributes": [{"trait_type": "color", "value": "#',
                              color[id].toColor(),
                              '"},{"trait_type": "chubbiness", "value": ',
                              uint2str(chubbiness[id]),
                              '}], "owner":"',
                              (uint160(ownerOf(id))).toHexString(20),
                              '", "image": "',
                              'data:image/svg+xml;base64,',
                              image,
                              '"}'
                          )
                        )
                    )
              )
          );
  }
// ç”Ÿæˆçš„ SVG å­—ç¬¦ä¸²
function generateSVGofTokenById(uint256 id) internal view returns (string memory) {
...
}

// ç»˜åˆ¶å›¾åƒ
// Visibility is `public` to enable it being called by other contracts for composition.
function renderTokenById(uint256 id) public view returns (string memory) {
...
}
```

å…¶ä¸­ï¼Œ `generateSVGofTokenById` å‡½æ•°è¿”å› `tokenId` å¯¹åº”çš„é¢œè‰²å’Œèƒ–ç˜¦å±æ€§ç”Ÿæˆçš„ SVG å­—ç¬¦ä¸²ï¼Œ `renderTokenById` ç”¨æˆ·ç»˜åˆ¶å›¾åƒã€‚

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒNFT å…ƒæ•°æ®ä¸­åŒ…å«çš„å±æ€§æœ‰ï¼š

- nameï¼šåç§°
- descriptionï¼š æè¿°
- external_urlï¼šå¤–éƒ¨é“¾æ¥
- attributesï¼šå±æ€§
    - color é¢œè‰²
    - chubbinessï¼šèƒ–ç˜¦
    - ownerï¼šæ‰€æœ‰è€…ï¼Œä»¥å¤ªåŠåœ°å€16è¿›åˆ¶å½¢å¼
    - imageï¼šå›¾ç‰‡å¯¹åº” SVG çš„ base64 ç¼–ç 

è¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡å®é™…æ•°æ®äº†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯ SVGã€‚`tokenId` ä¸º 1 æ—¶å¯¹åº”çš„ `tokenURI` ç»“æœä¸ºï¼š

```bash
data:application/json;base64,eyJuYW1lIjoiTG9vZ2llICMxIiwiZGVzY3JpcHRpb24iOiJUaGlzIExvb2dpZSBpcyB0aGUgY29sb3IgIzRjYzRjMSB3aXRoIGEgY2h1YmJpbmVzcyBvZiA4OCEhISIsImV4dGVybmFsX3VybCI6Imh0dHBzOi8vYnVybnlib3lzLmNvbS90b2tlbi8xIiwiYXR0cmlidXRlcyI6W3sidHJhaXRfdHlwZSI6ImNvbG9yIiwidmFsdWUiOiIjNGNjNGMxIn0seyJ0cmFpdF90eXBlIjoiY2h1YmJpbmVzcyIsInZhbHVlIjo4OH1dLCJvd25lciI6IjB4MTY5ODQxYWEzMDI0Y2ZhNTcwMDI0ZWI3ZGQ2YmY1Zjc3NDA5MjA4OCIsImltYWdlIjoiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTkRBd0lpQm9aV2xuYUhROUlqUXdNQ0lnZUcxc2JuTTlJbWgwZEhBNkx5OTNkM2N1ZHpNdWIzSm5Mekl3TURBdmMzWm5JajQ4WnlCcFpEMGlaWGxsTVNJK1BHVnNiR2x3YzJVZ2MzUnliMnRsTFhkcFpIUm9QU0l6SWlCeWVUMGlNamt1TlNJZ2NuZzlJakk1TGpVaUlHbGtQU0p6ZG1kZk1TSWdZM2s5SWpFMU5DNDFJaUJqZUQwaU1UZ3hMalVpSUhOMGNtOXJaVDBpSXpBd01DSWdabWxzYkQwaUkyWm1aaUl2UGp4bGJHeHBjSE5sSUhKNVBTSXpMalVpSUhKNFBTSXlMalVpSUdsa1BTSnpkbWRmTXlJZ1kzazlJakUxTkM0MUlpQmplRDBpTVRjekxqVWlJSE4wY205clpTMTNhV1IwYUQwaU15SWdjM1J5YjJ0bFBTSWpNREF3SWlCbWFXeHNQU0lqTURBd01EQXdJaTgrUEM5blBqeG5JR2xrUFNKb1pXRmtJajQ4Wld4c2FYQnpaU0JtYVd4c1BTSWpOR05qTkdNeElpQnpkSEp2YTJVdGQybGtkR2c5SWpNaUlHTjRQU0l5TURRdU5TSWdZM2s5SWpJeE1TNDRNREEyTlNJZ2FXUTlJbk4yWjE4MUlpQnllRDBpT0RnaUlISjVQU0kxTVM0NE1EQTJOU0lnYzNSeWIydGxQU0lqTURBd0lpOCtQQzluUGp4bklHbGtQU0psZVdVeUlqNDhaV3hzYVhCelpTQnpkSEp2YTJVdGQybGtkR2c5SWpNaUlISjVQU0l5T1M0MUlpQnllRDBpTWprdU5TSWdhV1E5SW5OMloxOHlJaUJqZVQwaU1UWTRMalVpSUdONFBTSXlNRGt1TlNJZ2MzUnliMnRsUFNJak1EQXdJaUJtYVd4c1BTSWpabVptSWk4K1BHVnNiR2x3YzJVZ2NuazlJak11TlNJZ2NuZzlJak1pSUdsa1BTSnpkbWRmTkNJZ1kzazlJakUyT1M0MUlpQmplRDBpTWpBNElpQnpkSEp2YTJVdGQybGtkR2c5SWpNaUlHWnBiR3c5SWlNd01EQXdNREFpSUhOMGNtOXJaVDBpSXpBd01DSXZQand2Wno0OEwzTjJaejQ9In0=
```

é€šè¿‡ base64 è§£ç  `data:application/json;base64,` ä¹‹åçš„å­—ç¬¦ä¸²å¯ä»¥å¾—åˆ°å¦‚ä¸‹ jsonï¼ˆä»¥ä¸‹ json ç»è¿‡äº†æ ¼å¼åŒ–ï¼Œæ–¹ä¾¿é˜…è¯»ï¼‰ï¼š

```json
{
  "name": "Loogie #1",
  "description": "This Loogie is the color #4cc4c1 with a chubbiness of 88!!!",
  "external_url": "https://burnyboys.com/token/1",
  "attributes": [
    {
      "trait_type": "color",
      "value": "#4cc4c1"
    },
    {
      "trait_type": "chubbiness",
      "value": 88
    }
  ],
  "owner": "0x169841aa3024cfa570024eb7dd6bf5f774092088",
  "image": "data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBpZD0iZXllMSI+PGVsbGlwc2Ugc3Ryb2tlLXdpZHRoPSIzIiByeT0iMjkuNSIgcng9IjI5LjUiIGlkPSJzdmdfMSIgY3k9IjE1NC41IiBjeD0iMTgxLjUiIHN0cm9rZT0iIzAwMCIgZmlsbD0iI2ZmZiIvPjxlbGxpcHNlIHJ5PSIzLjUiIHJ4PSIyLjUiIGlkPSJzdmdfMyIgY3k9IjE1NC41IiBjeD0iMTczLjUiIHN0cm9rZS13aWR0aD0iMyIgc3Ryb2tlPSIjMDAwIiBmaWxsPSIjMDAwMDAwIi8+PC9nPjxnIGlkPSJoZWFkIj48ZWxsaXBzZSBmaWxsPSIjNGNjNGMxIiBzdHJva2Utd2lkdGg9IjMiIGN4PSIyMDQuNSIgY3k9IjIxMS44MDA2NSIgaWQ9InN2Z181IiByeD0iODgiIHJ5PSI1MS44MDA2NSIgc3Ryb2tlPSIjMDAwIi8+PC9nPjxnIGlkPSJleWUyIj48ZWxsaXBzZSBzdHJva2Utd2lkdGg9IjMiIHJ5PSIyOS41IiByeD0iMjkuNSIgaWQ9InN2Z18yIiBjeT0iMTY4LjUiIGN4PSIyMDkuNSIgc3Ryb2tlPSIjMDAwIiBmaWxsPSIjZmZmIi8+PGVsbGlwc2Ugcnk9IjMuNSIgcng9IjMiIGlkPSJzdmdfNCIgY3k9IjE2OS41IiBjeD0iMjA4IiBzdHJva2Utd2lkdGg9IjMiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMCIvPjwvZz48L3N2Zz4="
}
```

æˆ‘ä»¬å¯¹ `image` å­—æ®µè¿›è¡Œè§£ç å¹¶æ ¼å¼åŒ–å°±å¾—åˆ°å›¾ç‰‡çš„ SVGï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="400" height="400">
   <g id="eye1">
      <ellipse stroke-width="3" ry="29.5" rx="29.5" id="svg_1" cy="154.5" cx="181.5" stroke="#000" fill="#fff" />
      <ellipse ry="3.5" rx="2.5" id="svg_3" cy="154.5" cx="173.5" stroke-width="3" stroke="#000" fill="#000000" />
   </g>
   <g id="head">
      <ellipse fill="#4cc4c1" stroke-width="3" cx="204.5" cy="211.80065" id="svg_5" rx="88" ry="51.80065" stroke="#000" />
   </g>
   <g id="eye2">
      <ellipse stroke-width="3" ry="29.5" rx="29.5" id="svg_2" cy="168.5" cx="209.5" stroke="#000" fill="#fff" />
      <ellipse ry="3.5" rx="3" id="svg_4" cy="169.5" cx="208" stroke-width="3" fill="#000000" stroke="#000" />
   </g>
</svg>
```

SVGæ˜¯ä¸€ç§ç”¨ XML å®šä¹‰çš„è¯­è¨€ï¼Œç”¨æ¥æè¿°äºŒç»´çŸ¢é‡åŠçŸ¢é‡/æ …æ ¼å›¾å½¢ã€‚å®ƒå¯ä»¥ä»»æ„æ”¾å¤§å›¾å½¢æ˜¾ç¤ºï¼Œä¹Ÿä¸ä¼šç‰ºç‰²å›¾åƒè´¨é‡ï¼Œå®ƒå¯ä»¥ä½¿ç”¨ä»£ç è¿›è¡Œæè¿°ï¼Œæ–¹ä¾¿ç¼–è¾‘ï¼Œå› æ­¤è¢«å¹¿æ³›ä½¿ç”¨ã€‚

ä»ä¸Šé¢çš„ä»£ç ç»“åˆä»¥ä¸‹çš„å›¾åƒå¯ä»¥çœ‹å‡ºï¼Œè¿™ä¸ª SVG åŒ…å«å¦‚ä¸‹å†…å®¹ï¼š

- ç¬¬ä¸€è¡Œä¸º XML å£°æ˜ï¼Œæ ‡æ˜ç‰ˆæœ¬å’Œç¼–ç ç±»å‹ï¼Œä¹‹åæ˜¯SVG çš„å®½åº¦å’Œé«˜åº¦ï¼›
- `eye1`ï¼šç”±ä¸¤ä¸ªæ¤­åœ†ï¼ˆellipseï¼‰ç»˜åˆ¶çš„çœ¼åœˆå’Œé»‘è‰²çœ¼ç ï¼›
- `head`ï¼šå¡«å…… `#4cc4c1` é¢œè‰²çš„æ¤­åœ†ä½œä¸ºèº«ä½“ï¼›
- `eye2`ï¼šä¸ `eye1` ä¸€è‡´ï¼Œä½ç½®ä¸åŒï¼›

`eye1`ï¼Œ`head`å’Œ`eye2`ä¾æ¬¡å åŠ å¾—åˆ°æœ€ç»ˆçš„å›¾å½¢ï¼š

![loogies-1](https://user-images.githubusercontent.com/3297411/153822497-6cdd7677-9594-4e78-8bc1-8f1b4c1158b8.png)

### è¾…åŠ©å‡½æ•°è§£æ

1. `uint2str` å°† `uint` è½¬å˜ä¸ºå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ `123` å˜ä¸º `'123'`

```solidity
function uint2str(uint _i) internal pure returns (string memory _uintAsString) {
      if (_i == 0) {
          return "0";
      }
      uint j = _i;
			// uint ä½æ•°
      uint len;
      while (j != 0) {
          len++;
          j /= 10;
      }
      bytes memory bstr = new bytes(len);
      uint k = len;
      while (_i != 0) {
          k = k-1;
			    // _i ä¸ªä½æ•°å­—
          uint8 temp = (48 + uint8(_i - _i / 10 * 10));
          bytes1 b1 = bytes1(temp);
          bstr[k] = b1;
          _i /= 10;
      }
      return string(bstr);
  }
```

1.  `ToColor.sol` åº“ï¼šå°† `byte3` ç±»å‹è½¬æ¢ä¸ºå‰ç«¯é¢œè‰²å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼šè¾“å…¥ `0x4cc4c1` è¾“å‡º `'4cc4c1'`

```solidity
library ToColor {
    bytes16 internal constant ALPHABET = '0123456789abcdef';

    function toColor(bytes3 value) internal pure returns (string memory) {
      bytes memory buffer = new bytes(6);
      for (uint256 i = 0; i < 3; i++) {
          buffer[i*2+1] = ALPHABET[uint8(value[i]) & 0xf];
          buffer[i*2] = ALPHABET[uint8(value[i]>>4) & 0xf];
      }
      return string(buffer);
    }
}
```

1.  `HexStrings.sol` åº“ï¼šä¸»è¦ä½œç”¨æ˜¯å°† `uint` æŒ‰ `length` ä½æå–ï¼Œå¯¹åº”äºç”Ÿæˆå…¬é’¥æ—¶æˆªå–å‰20ä½çš„åŠŸèƒ½ï¼š `(*uint160*(ownerOf(id))).toHexString(20)`ï¼Œæ­¤è¡¨è¾¾å¼ç”Ÿæˆå¯¹åº” `tokenId` æ‰€æœ‰è€…çš„åœ°å€ã€‚

```solidity
library HexStrings {
    bytes16 internal constant ALPHABET = '0123456789abcdef';

    function toHexString(uint256 value, uint256 length) internal pure returns (string memory) {
        bytes memory buffer = new bytes(2 * length + 2);
        buffer[0] = '0';
        buffer[1] = 'x';
        for (uint256 i = 2 * length + 1; i > 1; --i) {
            buffer[i] = ALPHABET[value & 0xf];
            value >>= 4;
        }
        return string(buffer);
    }
}
```

è‡³æ­¤ï¼Œåˆçº¦æºç åˆ†æå®Œæˆã€‚

ä¸‹é¢æˆ‘ä»¬å°†å¯¹å‰ç«¯çš„é€»è¾‘è¿›è¡Œç®€è¦åˆ†æï¼Œç„¶åæˆ‘ä»¬å°†ä¸€æ­¥æ­¥å®ç° NFT é“¸é€ å’Œå±•ç¤ºçš„åŠŸèƒ½ã€‚å°†ä»£ç åˆ‡æ¢åˆ°å‰ç«¯ä»£ç æäº¤ä¹‹å‰ï¼ŒæŒ‰ç…§ä»¥ä¸‹çš„æ­¥éª¤ä¸€æ­¥æ­¥æ·»åŠ åŠŸèƒ½ã€‚

```bash
git checkout a98156f6a03a0bc8fc98c8c77cef6fbf59f03b31
```

## å‰ç«¯é€»è¾‘åˆ†æ

é¡¹ç›®å‰ç«¯æ–‡ä»¶åœ¨ `packages/react-app` å†…ï¼Œä»¥ä¸‹æ–‡ç« ä¸­æ¶‰åŠæ–‡ä»¶çš„ä½ç½®éƒ½å°†åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å¯»æ‰¾ã€‚

æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ `src/App.jsx` ï¼Œè¿™æ˜¯é¡¹ç›®çš„ä¸»è¦é¡µé¢ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä»£ç ç¼–è¾‘å™¨æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶çš„ä¸»è¦éƒ¨åˆ†ï¼š

![Appjsx](https://user-images.githubusercontent.com/3297411/153822564-f2f96aa8-1336-475b-adc8-cc251405cdff.png)

å…¶ä¸­åŒ…å«çš„åŠŸèƒ½å’Œç»„ä»¶åŒ…æ‹¬ï¼š

- `Header`ï¼šæ ‡é¢˜æ ï¼Œæ˜¾ç¤ºæ ‡é¢˜
- *`NetworkDisplay`ï¼šæ‰€å¤„ç½‘ç»œçŠ¶æ€*
- *`Menu`ï¼Œ `Switch`ï¼šèœå•åˆ‡æ¢*
- *`ThemeSwitch`ï¼šå³ä¸‹è§’æ˜æš—ä¸»é¢˜åˆ‡æ¢*
- *`Account`ï¼šå³ä¸Šè§’è´¦æˆ·ä¿¡æ¯ç»„ä»¶*
- æ¥ä¸‹æ¥çš„ä¸¤ä¸ª `Row` å¯¹åº”å·¦ä¸‹è§’çš„ Gas æ˜¾ç¤ºã€æ”¯æŒå’Œæœ¬åœ°çš„æ°´é¾™å¤´

ä¸‹é¢æˆ‘ä»¬ä¸»è¦çœ‹ä¸€ä¸‹ *`NetworkDisplay`å’Œ `Account` çš„é€»è¾‘å®ç°ï¼Œä»¥åŠ `Menu`ï¼Œ `Switch` ä¸­çš„åŠŸèƒ½ã€‚*

### *`NetworkDisplay`*

ç»„ä»¶ä½ç½®ï¼š `src/components/NetworkDisplay.jsx`

ä¸»è¦åŒ…å«ä¸¤ä¸ªåŠŸèƒ½ï¼š

1. æ˜¾ç¤ºå½“å‰æ‰€é€‰æ‹©çš„ç½‘ç»œåç§°ï¼›
2. å¦‚æœå½“å‰é’±åŒ…æ‰€åœ¨ç½‘ç»œä¸é¡¹ç›®ä¸­ç½‘ç»œè®¾ç½®ä¸ä¸€è‡´ï¼Œåˆ™æç¤ºè­¦å‘Šï¼Œå…¶ä¸­ï¼Œå½“é€‰æ‹©æœ¬åœ°ç½‘ç»œæ˜¯ï¼Œç½‘ç»œ ID éœ€è¦è®¾ç½®ä¸º `31337` ã€‚

```jsx
function NetworkDisplay({
  NETWORKCHECK,
  localChainId,
  selectedChainId,
  targetNetwork,
  USE_NETWORK_SELECTOR,
  logoutOfWeb3Modal,
}) {
  let networkDisplay = "";
  if (NETWORKCHECK && localChainId && selectedChainId && localChainId !== selectedChainId) {
    const networkSelected = NETWORK(selectedChainId);
    const networkLocal = NETWORK(localChainId);
    if (selectedChainId === 1337 && localChainId === 31337) {
			// æç¤ºé”™è¯¯çš„ç½‘ç»œID
			...
    } else {
			// æç¤ºç½‘ç»œé”™è¯¯
			...
    }
  } else {
    networkDisplay = USE_NETWORK_SELECTOR ? null : (
      // æ˜¾ç¤ºç½‘ç»œåç§°
      <div style={{ zIndex: -1, position: "absolute", right: 154, top: 28, padding: 16, color: targetNetwork.color }}>
        {targetNetwork.name}
      </div>
    );
  }

  console.log({ networkDisplay });

  return networkDisplay;
}
```

### *`Account`*

ç»„ä»¶ä½ç½®ï¼š `src/components/Account.jsx`

ä¸»è¦åŒ…å«ä¸¤ä¸ªåŠŸèƒ½ï¼š

1. æ˜¾ç¤ºå½“å‰é’±åŒ…
2. æ˜¾ç¤ºé’±åŒ…ä½™é¢
3. æ˜¾ç¤º `Connect` æˆ–è€… `Logout`

å…¶ä¸­ï¼Œå½“ç”¨æˆ·ç‚¹å‡» `Connect` æ—¶ï¼Œå‰ç«¯è°ƒç”¨ *`loadWeb3Modal`ï¼Œä»£ç å¦‚ä¸‹ï¼Œè¿™ä¸ªå‡½æ•°çš„éœ€è¦åŠŸèƒ½æ˜¯ä¸MetaMaskç­‰é’±åŒ…è¿›è¡Œè¿æ¥ï¼Œå¹¶ç›‘å¬é’±åŒ…çš„*  `chainChanged`ï¼Œ`accountsChanged` å’Œ `disconnect` äº‹ä»¶ï¼Œå³å½“æˆ‘ä»¬åœ¨é’±åŒ…ä¸­åˆ‡æ¢ç½‘ç»œï¼Œé€‰æ‹©è¿æ¥è´¦æˆ·ä»¥åŠå–æ¶ˆè¿æ¥æ—¶å¯¹åº”ä¿®æ”¹æ˜¾ç¤ºçŠ¶æ€ã€‚

```jsx
  const loadWeb3Modal = useCallback(async () => {
		// è¿æ¥é’±åŒ…
    const provider = await web3Modal.connect();
    setInjectedProvider(new ethers.providers.Web3Provider(provider));
		// ç›‘å¬åˆ‡æ¢ç½‘ç»œ
    provider.on("chainChanged", chainId => {
      console.log(`chain changed to ${chainId}! updating providers`);
      setInjectedProvider(new ethers.providers.Web3Provider(provider));
    });
    // ç›‘å¬åˆ‡æ¢è´¦æˆ·
    provider.on("accountsChanged", () => {
      console.log(`account changed!`);
      setInjectedProvider(new ethers.providers.Web3Provider(provider));
    });
		// ç›‘å¬æ–­å¼€è¿æ¥
    // Subscribe to session disconnection
    provider.on("disconnect", (code, reason) => {
      console.log(code, reason);
      logoutOfWeb3Modal();
    });
    // eslint-disable-next-line
  }, [setInjectedProvider]);
```

åŒç†ï¼Œåœ¨è¿æ¥é’±åŒ…æƒ…å†µä¸‹ï¼Œç”¨æˆ·ç‚¹å‡» `Logout` ä¼šè°ƒç”¨ `logoutOfWeb3Modal` åŠŸèƒ½ï¼Œ

```jsx
const logoutOfWeb3Modal = async () => {
		// æ¸…æ¥šç¼“å­˜çš„ç½‘ç»œæä¾›å•†ï¼Œå¹¶æ–­å¼€è¿æ¥
    await web3Modal.clearCachedProvider();
    if (injectedProvider && injectedProvider.provider && typeof injectedProvider.provider.disconnect == "function") {
      await injectedProvider.provider.disconnect();
    }
    setTimeout(() => {
      window.location.reload();
    }, 1);
  };
```

### *`Menu`ï¼Œ `Switch`*

è¿™ä¸¤ä¸ªåˆ†åˆ«å¯¹åº”æ˜¾ç¤ºèœå•å’Œå¯¹åº”åˆ‡æ¢èœå•åŠŸèƒ½ï¼Œè¿™äº›èœå•åŒ…æ‹¬ï¼š

- `App Home` ï¼šé¡¹ç›®å¸Œæœ›æˆ‘ä»¬å°†éœ€è¦å®ç°çš„åŠŸèƒ½æ”¾åœ¨è¿™ä¸ªèœå•ä¸­ï¼Œæ¯”å¦‚æˆ‘ä»¬å°†è¦å®ç°çš„ NFT çš„é“¸é€ å’Œå±•ç¤ºåŠŸèƒ½ï¼›
- `Debug Contracts`ï¼šè°ƒè¯•è‡ªå·±ç¼–å†™çš„åˆçº¦åŠŸèƒ½ï¼Œå°†ä¼šæ ¹æ®åˆçº¦çš„ ABI æ–‡ä»¶ å±•ç¤ºå¯ä»¥åˆçº¦çš„çŠ¶æ€å˜é‡å’Œå¯ä»¥è°ƒç”¨çš„å‡½æ•°ï¼›
- `Hints`ï¼šç¼–ç¨‹æç¤º
- `ExampleUI`ï¼šç¤ºä¾‹UIï¼Œå¯ä»¥åšä¸ºç¼–ç¨‹ä½¿ç”¨
- `Mainnet DAI`ï¼šä»¥å¤ªåŠä¸»ç½‘ `DAI` çš„åˆçº¦çŠ¶æ€å’Œå¯ç”¨å‡½æ•°ï¼Œä¸ `Debug Contracts` åŠŸèƒ½ä¸€ç›´
- `Subgraph`ï¼šä½¿ç”¨ The Graph åè®®å¯¹åˆçº¦ä¸­çš„äº‹ä»¶è¿›è¡Œç›‘å¬å’ŒæŸ¥è¯¢ã€‚

### è°ƒè¯•ä¿¡æ¯

`App.jsx` ä¸­è¿˜åŒ…å«äº†æ‰“å°å½“å‰é¡µé¢çŠ¶æ€çš„è°ƒè¯•ä¿¡æ¯ï¼Œå¯ä»¥åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­å®æ—¶æŸ¥çœ‹å½“å‰çŠ¶æ€å˜é‡ã€‚

```jsx
  //
  // ğŸ§« DEBUG ğŸ‘¨ğŸ»â€ğŸ”¬
  //
  useEffect(() => {
    if (
      DEBUG &&
      mainnetProvider &&
      address &&
      selectedChainId &&
      yourLocalBalance &&
      yourMainnetBalance &&
      readContracts &&
      writeContracts &&
      mainnetContracts
    ) {
      console.log("_____________________________________ ğŸ— scaffold-eth _____________________________________");
      console.log("ğŸŒ mainnetProvider", mainnetProvider);
      console.log("ğŸ  localChainId", localChainId);
      console.log("ğŸ‘©â€ğŸ’¼ selected address:", address);
      console.log("ğŸ•µğŸ»â€â™‚ï¸ selectedChainId:", selectedChainId);
      console.log("ğŸ’µ yourLocalBalance", yourLocalBalance ? ethers.utils.formatEther(yourLocalBalance) : "...");
      console.log("ğŸ’µ yourMainnetBalance", yourMainnetBalance ? ethers.utils.formatEther(yourMainnetBalance) : "...");
      console.log("ğŸ“ readContracts", readContracts);
      console.log("ğŸŒ DAI contract on mainnet:", mainnetContracts);
      console.log("ğŸ’µ yourMainnetDAIBalance", myMainnetDAIBalance);
      console.log("ğŸ” writeContracts", writeContracts);
    }
  }, [
    mainnetProvider,
    address,
    selectedChainId,
    yourLocalBalance,
    yourMainnetBalance,
    readContracts,
    writeContracts,
    mainnetContracts,
    localChainId,
    myMainnetDAIBalance,
  ]);
```

æŸ¥çœ‹å®Œä¸»é¡µçš„åŸºæœ¬åŠŸèƒ½ï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹å®ç° NFT é“¸é€ å’Œå±•ç¤º NFT åˆ—è¡¨è¿™ä¸¤ä¸ªåŠŸèƒ½ã€‚

## NFT åŠŸèƒ½å®ç°

æˆ‘ä»¬å°†ä¸»è¦å®ç°ä»¥ä¸‹ä¸‰ä¸ªéƒ¨åˆ†åŠŸèƒ½ï¼š

- é“¸é€  NFTï¼›
- å±•ç¤º NFT åˆ—è¡¨ï¼›
- å±•ç¤º NFT åˆçº¦æ¥å£åˆ—è¡¨ã€‚

### é“¸é€  NFT

é¦–å…ˆæˆ‘ä»¬æ‰¾åˆ° `App Home` å¯¹åº”ä½¿ç”¨çš„ç»„ä»¶ï¼Œä»ä¸‹é¢çš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå¯¹åº”ä½¿ç”¨ `Home` ç»„ä»¶ï¼Œæ‰€åœ¨ä½ç½®ä¸º `src/views/Home.jsx` ã€‚

```jsx
    ...
    <Switch>
        <Route exact path="/">
          {/* pass in any web3 props to this Home component. For example, yourLocalBalance */}
          <Home yourLocalBalance={yourLocalBalance} readContracts={readContracts} />
        </Route>
    ....
```

åˆ é™¤ `Home.jsx` ä¸­å†…å®¹ï¼Œæ·»åŠ ä»¥ä¸‹ Mint æŒ‰é’®ï¼š

```jsx
import React, { useState } from "react";
import { Button, Card, List } from "antd";

function Home({ 
  isSigner,
  loadWeb3Modal,
  tx,
  writeContracts,
}) {

  return (
    <div>
      {/* Mint button */}
      <div style={{ maxWidth: 820, margin: "auto", marginTop: 32, paddingBottom: 32 }}>
        {isSigner?(
          <Button type={"primary"} onClick={()=>{
            tx( writeContracts.YourCollectible.mintItem() )
          }}>MINT</Button>
        ):(
          <Button type={"primary"} onClick={loadWeb3Modal}>CONNECT WALLET</Button>
        )}
      </div>
    </div>
  );
}

export default Home;
```

åŒæ—¶å°† `Switch` ä¸­å¯¹åº”ç»„ä»¶ä½¿ç”¨ä¿®æ”¹ä¸ºï¼š

```jsx
      ...
      <Switch>
        <Route exact path="/">
          {/* pass in any web3 props to this Home component. For example, yourLocalBalance */}
          <Home
            isSigner={userSigner}
            loadWeb3Modal={loadWeb3Modal}
            tx={tx}
            writeContracts={writeContracts}
          />
       ...
```

æ•ˆæœå›¾ä¸ºï¼š

![mint-button](https://user-images.githubusercontent.com/3297411/153822638-2ce70ded-289b-411e-9ed5-c78507617427.png)

ç‚¹å‡» Mint ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°äº¤æ˜“æˆåŠŸå‘å‡ºï¼Œè¿™æ—¶ï¼Œè™½ç„¶æˆ‘ä»¬æˆåŠŸ mint äº† NFTï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦æ·»åŠ åˆ—è¡¨æ¥å±•ç¤ºæˆ‘ä»¬çš„ NFTã€‚

### å±•ç¤º NFT åˆ—è¡¨

æ·»åŠ åˆ—è¡¨å±•ç¤ºï¼Œå…¶ä¸­åŒ…å« NFT çš„è½¬ç§»åŠŸèƒ½å¯ä»¥å°†å¯¹åº”çš„ NFT å‘é€ç»™å…¶ä»–åœ°å€ã€‚

```jsx
import React, { useState } from "react";
import { Button, Card, List } from "antd";
import { useContractReader } from "eth-hooks";
import { Address, AddressInput} from "../components";

function Home({ 
  isSigner,
  loadWeb3Modal,
  yourCollectibles,
  address,
  blockExplorer,
  mainnetProvider,
  tx,
  readContracts,
  writeContracts,
}) {
  const [transferToAddresses, setTransferToAddresses] = useState({});

  return (
    <div>
      {/* Mint æŒ‰é’® */}
			...
			{/* åˆ—è¡¨ */}
      <div style={{ width: 820, margin: "auto", paddingBottom: 256 }}>
        <List
          bordered
          dataSource={yourCollectibles}
          renderItem={item => {
            const id = item.id.toNumber();
            console.log("IMAGE",item.image)
            return (
              <List.Item key={id + "_" + item.uri + "_" + item.owner}>
                <Card
                  title={
                    <div>
                      <span style={{ fontSize: 18, marginRight: 8 }}>{item.name}</span>
                    </div>
                  }
                >
                  <a href={"https://opensea.io/assets/"+(readContracts && readContracts.YourCollectible && readContracts.YourCollectible.address)+"/"+item.id} target="_blank">
                  <img src={item.image} />
                  </a>
                  <div>{item.description}</div>
                </Card>
								{/* NFT è½¬ç§» */}
                <div>
                  owner:{" "}
                  <Address
                    address={item.owner}
                    ensProvider={mainnetProvider}
                    blockExplorer={blockExplorer}
                    fontSize={16}
                  />
                  <AddressInput
                    ensProvider={mainnetProvider}
                    placeholder="transfer to address"
                    value={transferToAddresses[id]}
                    onChange={newValue => {
                      const update = {};
                      update[id] = newValue;
                      setTransferToAddresses({ ...transferToAddresses, ...update });
                    }}
                  />
                  <Button
                    onClick={() => {
                      console.log("writeContracts", writeContracts);
                      tx(writeContracts.YourCollectible.transferFrom(address, transferToAddresses[id], id));
                    }}
                  >
                    Transfer
                  </Button>
                </div>
              </List.Item>
            );
          }}
        />
      </div>
      {/* ä¿¡æ¯æç¤º */}
      <div style={{ maxWidth: 820, margin: "auto", marginTop: 32, paddingBottom: 256 }}>
        ğŸ›  built with <a href="https://github.com/austintgriffith/scaffold-eth" target="_blank">ğŸ— scaffold-eth</a>
        ğŸ´ <a href="https://github.com/austintgriffith/scaffold-eth" target="_blank">Fork this repo</a> and build a cool SVG NFT!
      </div>
    </div>
  );
}

export default Home;
```

å¯¹åº”ç»„ä»¶ä½¿ç”¨ä¿®æ”¹ä¸ºï¼š

```jsx
      ...
      <Switch>
        <Route exact path="/">
          {/* pass in any web3 props to this Home component. For example, yourLocalBalance */}
          <Home
            isSigner={userSigner}
            loadWeb3Modal={loadWeb3Modal}
            yourCollectibles={yourCollectibles}
            address={address}
            blockExplorer={blockExplorer}
            mainnetProvider={mainnetProvider}
            tx={tx}
            writeContracts={writeContracts}
            readContracts={readContracts}
          />
       ...
```

æ•ˆæœå›¾ä¸ºï¼š

![nft-display-list](https://user-images.githubusercontent.com/3297411/153822686-e7f7c3c7-65ee-4b1c-ade2-204c6365177f.png)

ä½†æ˜¯æˆ‘ä»¬å‘ç°ï¼Œå½“æˆ‘ä»¬å†æ¬¡ mint æ—¶ï¼Œåˆ—è¡¨å¹¶ä¸ä¼šæ›´æ–°ï¼Œè¿˜æ˜¯åŸæ¥çš„æ ·å­ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åœ¨ `App.jsx` ä¸­æ·»åŠ äº‹ä»¶ç›‘å¬ï¼Œä¸€æ—¦æˆ‘ä»¬é“¸é€  NFT ä¹‹åï¼Œåˆ—è¡¨å°†åˆ·æ–°ï¼š

```jsx
  // è·Ÿè¸ªå½“å‰ NFT æ•°é‡
  const balance = useContractReader(readContracts, "YourCollectible", "balanceOf", [address]);
  console.log("ğŸ¤— balance:", balance);

  const yourBalance = balance && balance.toNumber && balance.toNumber();
  const [yourCollectibles, setYourCollectibles] = useState();
  //
  // ğŸ§  è¿™ä¸ª effect ä¼šåœ¨ balance å˜åŒ–æ—¶æ›´æ–° yourCollectibles 
  //
  useEffect(() => {
    const updateYourCollectibles = async () => {
      const collectibleUpdate = [];
      for (let tokenIndex = 0; tokenIndex < balance; tokenIndex++) {
        try {
          console.log("GEtting token index", tokenIndex);
          const tokenId = await readContracts.YourCollectible.tokenOfOwnerByIndex(address, tokenIndex);
          console.log("tokenId", tokenId);
          const tokenURI = await readContracts.YourCollectible.tokenURI(tokenId);
          const jsonManifestString = atob(tokenURI.substring(29))
          console.log("jsonManifestString", jsonManifestString);

          try {
            const jsonManifest = JSON.parse(jsonManifestString);
            console.log("jsonManifest", jsonManifest);
            collectibleUpdate.push({ id: tokenId, uri: tokenURI, owner: address, ...jsonManifest });
          } catch (e) {
            console.log(e);
          }

        } catch (e) {
          console.log(e);
        }
      }
      setYourCollectibles(collectibleUpdate.reverse());
    };
    updateYourCollectibles();
  }, [address, yourBalance]);
```

æ­¤æ—¶ï¼Œå½“æˆ‘ä»¬å†æ¬¡ Mint æ—¶ï¼Œå°±æ˜¯è‡ªåŠ¨æ›´æ–°åˆ—è¡¨ï¼Œæ˜¾ç¤ºæœ€æ–°é“¸é€ çš„ NFT äº†ã€‚

### å±•ç¤º NFT åˆçº¦æ¥å£åˆ—è¡¨

è¿™ä¸ªåŠŸèƒ½æ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦ä¿®æ”¹å¯¹åº” debug éƒ¨åˆ†å³å¯ï¼š

```jsx
      <Route exact path="/debug">
          {/*
                ğŸ› this scaffolding is full of commonly used components
                this <Contract/> component will automatically parse your ABI
                and give you a form to interact with it locally
            */}

          <Contract
            name="YourCollectible"
            price={price}
            signer={userSigner}
            provider={localProvider}
            address={address}
            blockExplorer={blockExplorer}
            contractConfig={contractConfig}
          />
```

æ›´æ–°ä¹‹åï¼Œå¯ä»¥åœ¨ `Debug Contracts` èœå•ä¸‹çœ‹åˆ°åˆçº¦çš„å¯ä»¥è°ƒç”¨çš„å‡½æ•°ã€‚

![contract-funcs](https://user-images.githubusercontent.com/3297411/153822741-30c8d3c6-077b-49b9-8b88-bc62119215cf.png)

è‡³æ­¤ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ä¸€ä¸ªç®€å• NFT é“¸é€ å’Œå±•ç¤ºçš„ DApp äº†ã€‚

## æ€»ç»“

é€šè¿‡è¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬å¯ä»¥å­¦ä¹ å¹¶äº†è§£ä»¥ä¸‹çŸ¥è¯†ï¼š

1. NFT åˆçº¦åŸºæœ¬å†…å®¹ä»¥åŠå¦‚ä½•åœ¨ Opensea ç­‰å¸‚åœºä¸­å±•ç¤º NFTï¼›
2. å‰ç«¯å¦‚ä½•è¿æ¥è¯¸å¦‚ MetaMask ç­‰é’±åŒ…ï¼›
3. å‰ç«¯å¦‚ä½•è°ƒç”¨åˆçº¦å‡½æ•°ã€‚


### Comments

